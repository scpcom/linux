// SPDX-License-Identifier: GPL-2.0
/dts-v1/;
#include "ls1024a.dtsi"
#include <dt-bindings/gpio/gpio.h>

/ {
	model = "QNAP TS-x31";
	compatible = "qnap,tsx31", "fsl,ls1024a";

	chosen {
		bootargs = "console=ttyS0,115200n8 earlyprintk";
		stdout-path = &uart1;
	};

	a9dp_opp_table: a9dp_opp_table {
		compatible = "operating-points-v2";
		opp-shared;

		opp-1200000000 {
			opp-hz = /bits/ 64 <1200000000>;
		};
		opp-600000000 {
			opp-hz = /bits/ 64 <600000000>;
		};
		opp-300000000 {
			opp-hz = /bits/ 64 <300000000>;
		};
	};

	soc {
		poweroff {
			compatible = "qnap,power-off";
			reg = <0x96300000 0x100000>;
			clocks = <&clkcore LS1024A_CLK_DUS>;
		};
	};

	leds {
		compatible = "gpio-leds";
		hdd1-error {
			gpios = <&gpio 47 GPIO_ACTIVE_LOW>;
		};
		hdd2-error {
			gpios = <&gpio 46 GPIO_ACTIVE_LOW>;
		};
		hdd3-error {
			gpios = <&gpio 45 GPIO_ACTIVE_LOW>;
		};
		hdd4-error {
			gpios = <&gpio 44 GPIO_ACTIVE_LOW>;
		};
	};
};

&cpu0 {
	operating-points-v2 = <&a9dp_opp_table>;
};
&cpu1 {
	operating-points-v2 = <&a9dp_opp_table>;
};

&i2c {
	clock-frequency = <400000>;
	status = "okay";

	s35390a@30 {
		compatible = "sii,s35390a";
		reg = <0x30>;
	};

	at24c04@50 {
		compatible = "atmel,24c04";
		reg = <0x50>;
		read-only;
	};

	at24c04@56 {
		compatible = "atmel,24c04";
		reg = <0x56>;
		read-only;
	};
};

&serdes0 {
	fsl,pcie-use-external-clk;
};

&serdes1 {
	fsl,pcie-use-external-clk;
	fsl,sata-txlev = <9>;
};

&uart0 {
	status = "okay";
};
&uart1 {
	status = "okay";

	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
};

&sata {
	ports-implemented = <3>;
	status = "okay";
};

&usb3_phy {
	status = "okay";
};

&usb3 {
	dr_mode = "host";
	status = "okay";
};
